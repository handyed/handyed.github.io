<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Quote Management</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      color: #333;
    }
    
    .header {
      background: linear-gradient(135deg, #0a7e8c, #05545d);
      color: white;
      padding: 20px 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .header h1 {
      font-size: 24px;
      font-weight: 300;
    }
    
    .header .stats {
      display: flex;
      gap: 30px;
      margin-top: 15px;
      font-size: 14px;
    }
    
    .stat-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px;
    }
    
    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .search-box {
      flex: 1;
      max-width: 300px;
    }
    
    .search-box input {
      width: 100%;
      padding: 12px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .search-box input:focus {
      outline: none;
      border-color: #0a7e8c;
    }
    
    .filter-select {
      padding: 12px 15px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      background: white;
      font-size: 14px;
      cursor: pointer;
    }
    
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #0a7e8c, #05545d);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(10, 126, 140, 0.3);
    }
    
    .btn-success {
      background: #28a745;
      color: white;
    }
    
    .btn-warning {
      background: #ffc107;
      color: #212529;
    }
    
    .btn-danger {
      background: #dc3545;
      color: white;
    }
    
    .quotes-grid {
      display: grid;
      gap: 20px;
    }
    
    .quote-card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.05);
      border: 1px solid #e1e5e9;
      transition: all 0.3s ease;
    }
    
    .quote-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 25px rgba(0,0,0,0.1);
    }
    
    .quote-header {
      display: flex;
      justify-content: between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .client-info {
      flex: 1;
    }
    
    .client-name {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }
    
    .client-contact {
      font-size: 14px;
      color: #666;
    }
    
    .quote-status {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .status-new {
      background: #e3f2fd;
      color: #1976d2;
    }
    
    .status-contacted {
      background: #fff3e0;
      color: #f57c00;
    }
    
    .status-quoted {
      background: #e8f5e8;
      color: #388e3c;
    }
    
    .status-completed {
      background: #f3e5f5;
      color: #7b1fa2;
    }
    
    .quote-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .detail-item {
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #0a7e8c;
    }
    
    .detail-label {
      font-size: 12px;
      color: #666;
      text-transform: uppercase;
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .detail-value {
      font-size: 14px;
      color: #333;
    }
    
    .project-description {
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #28a745;
    }
    
    .quote-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .quote-actions .btn {
      padding: 8px 16px;
      font-size: 12px;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }
    
    .empty-state h3 {
      margin-bottom: 10px;
      color: #999;
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 20px 15px;
      }
      
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .search-box {
        max-width: none;
      }
      
      .quote-details {
        grid-template-columns: 1fr;
      }
      
      .quote-actions {
        justify-content: center;
      }
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
    }
    
    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #666;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #333;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 10px 15px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üìã Quote Management Dashboard</h1>
    <div class="stats">
      <div class="stat-item">
        <span>üÜï New Quotes:</span>
        <strong id="newCount">0</strong>
      </div>
      <div class="stat-item">
        <span>üìû In Progress:</span>
        <strong id="progressCount">0</strong>
      </div>
      <div class="stat-item">
        <span>‚úÖ Completed:</span>
        <strong id="completedCount">0</strong>
      </div>
      <div class="stat-item">
        <span>üìä Total:</span>
        <strong id="totalCount">0</strong>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="controls">
      <div class="search-box">
        <input type="text" id="searchInput" placeholder="üîç Search by name, email, or service...">
      </div>
      
      <select class="filter-select" id="statusFilter">
        <option value="">All Statuses</option>
        <option value="new">New</option>
        <option value="contacted">Contacted</option>
        <option value="quoted">Quoted</option>
        <option value="completed">Completed</option>
      </select>
      
      <select class="filter-select" id="serviceFilter">
        <option value="">All Services</option>
        <option value="home-improvement">Home Improvement</option>
        <option value="plumbing">Plumbing</option>
        <option value="electrical">Electrical Work</option>
        <option value="heating-cooling">Heating & Cooling</option>
        <option value="roofing">Roofing</option>
        <option value="painting">Painting & Decorating</option>
        <option value="garden-landscaping">Garden & Landscaping</option>
        <option value="cleaning">Cleaning Services</option>
        <option value="other">Other</option>
      </select>
      
      <button class="btn btn-primary" onclick="addSampleData()">üìù Add Sample Data</button>
      <button class="btn btn-primary" onclick="exportData()">üì§ Export CSV</button>
    </div>

    <div class="quotes-grid" id="quotesGrid">
      <div class="empty-state">
        <h3>No quote requests yet</h3>
        <p>New quotes will appear here when customers submit the form</p>
        <button class="btn btn-primary" onclick="addSampleData()" style="margin-top: 20px;">Add Some Sample Data</button>
      </div>
    </div>
  </div>

  <!-- Quote Details Modal -->
  <div class="modal" id="quoteModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Update Quote Status</h3>
        <button class="close-modal" onclick="closeModal()">&times;</button>
      </div>
      
      <form id="updateForm">
        <div class="form-group">
          <label for="modalStatus">Status</label>
          <select id="modalStatus" name="status">
            <option value="new">New</option>
            <option value="contacted">Contacted</option>
            <option value="quoted">Quoted</option>
            <option value="completed">Completed</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="modalNotes">Admin Notes</label>
          <textarea id="modalNotes" name="notes" placeholder="Add your notes about this quote..."></textarea>
        </div>
        
        <div class="form-group">
          <label for="modalQuoteAmount">Quote Amount (¬£)</label>
          <input type="number" id="modalQuoteAmount" name="quoteAmount" placeholder="0.00" step="0.01">
        </div>
        
        <div style="display: flex; gap: 10px; justify-content: flex-end;">
          <button type="button" class="btn" onclick="closeModal()">Cancel</button>
          <button type="submit" class="btn btn-success">Update Quote</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Sample data structure that matches your form
    let quotes = JSON.parse(localStorage.getItem('quoteRequests') || '[]');
    let currentEditId = null;

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', function() {
      renderQuotes();
      updateStats();
      setupEventListeners();
    });

    function setupEventListeners() {
      document.getElementById('searchInput').addEventListener('input', filterQuotes);
      document.getElementById('statusFilter').addEventListener('change', filterQuotes);
      document.getElementById('serviceFilter').addEventListener('change', filterQuotes);
      
      document.getElementById('updateForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateQuoteStatus();
      });
    }

    function addSampleData() {
      const sampleQuotes = [
        {
          id: Date.now() + 1,
          fullName: 'Sarah Johnson',
          email: 'sarah.johnson@email.com',
          phone: '07123 456789',
          streetAddress: '45 Oak Tree Lane',
          city: 'Manchester',
          postcode: 'M14 6HG',
          county: 'Greater Manchester',
          serviceType: 'plumbing',
          projectDetails: 'Bathroom renovation - need new shower installation and pipe work',
          budget: '2500-5000',
          urgency: 'within-month',
          contactPreference: 'phone',
          hearAboutUs: 'google-search',
          submissionDate: new Date().toISOString(),
          status: 'new',
          adminNotes: '',
          quoteAmount: null
        },
        {
          id: Date.now() + 2,
          fullName: 'Michael Brown',
          email: 'mike.brown@email.com',
          phone: '07987 654321',
          streetAddress: '12 Victoria Street',
          city: 'London',
          postcode: 'SW1A 1AA',
          county: 'Greater London',
          serviceType: 'electrical',
          projectDetails: 'Need full house rewiring for 3-bedroom house, urgent safety issue',
          budget: 'over-10000',
          urgency: 'asap',
          contactPreference: 'phone',
          hearAboutUs: 'friend-referral',
          submissionDate: new Date(Date.now() - 86400000).toISOString(),
          status: 'contacted',
          adminNotes: 'Called customer, scheduled site visit for tomorrow',
          quoteAmount: null
        },
        {
          id: Date.now() + 3,
          fullName: 'Emma Wilson',
          email: 'emma.wilson@email.com',
          phone: '07555 123456',
          streetAddress: '78 High Street',
          city: 'Birmingham',
          postcode: 'B1 2HG',
          county: 'West Midlands',
          serviceType: 'painting',
          projectDetails: 'Interior painting for living room and kitchen, need color consultation',
          budget: '1000-2500',
          urgency: 'within-3months',
          contactPreference: 'email',
          hearAboutUs: 'social-media',
          submissionDate: new Date(Date.now() - 172800000).toISOString(),
          status: 'quoted',
          adminNotes: 'Quote sent via email: ¬£1,850 including materials',
          quoteAmount: 1850
        }
      ];

      quotes = [...quotes, ...sampleQuotes];
      localStorage.setItem('quoteRequests', JSON.stringify(quotes));
      renderQuotes();
      updateStats();
      alert('‚úÖ Sample data added successfully!');
    }

    function renderQuotes() {
      const grid = document.getElementById('quotesGrid');
      
      if (quotes.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <h3>No quote requests yet</h3>
            <p>New quotes will appear here when customers submit the form</p>
            <button class="btn btn-primary" onclick="addSampleData()" style="margin-top: 20px;">Add Some Sample Data</button>
          </div>`;
        return;
      }

      const html = quotes.map(quote => createQuoteCard(quote)).join('');
      grid.innerHTML = html;
    }

    function createQuoteCard(quote) {
      const date = new Date(quote.submissionDate).toLocaleDateString('en-GB');
      const time = new Date(quote.submissionDate).toLocaleTimeString('en-GB', {hour: '2-digit', minute: '2-digit'});
      
      return `
        <div class="quote-card" data-id="${quote.id}">
          <div class="quote-header">
            <div class="client-info">
              <div class="client-name">${quote.fullName}</div>
              <div class="client-contact">
                üìß ${quote.email} | üìû ${quote.phone}
              </div>
            </div>
            <div class="quote-status status-${quote.status}">${quote.status}</div>
          </div>

          <div class="quote-details">
            <div class="detail-item">
              <div class="detail-label">Address</div>
              <div class="detail-value">${quote.streetAddress}<br>${quote.city}, ${quote.postcode}</div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label">Service Type</div>
              <div class="detail-value">${formatServiceType(quote.serviceType)}</div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label">Budget Range</div>
              <div class="detail-value">${formatBudget(quote.budget)}</div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label">Urgency</div>
              <div class="detail-value">${formatUrgency(quote.urgency)}</div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label">Contact Preference</div>
              <div class="detail-value">${formatContactPreference(quote.contactPreference)}</div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label">Submitted</div>
              <div class="detail-value">${date} at ${time}</div>
            </div>
          </div>

          ${quote.projectDetails ? `
            <div class="project-description">
              <div class="detail-label">Project Details</div>
              <div class="detail-value">${quote.projectDetails}</div>
            </div>
          ` : ''}

          ${quote.adminNotes ? `
            <div class="project-description" style="border-left-color: #ffc107;">
              <div class="detail-label">Admin Notes</div>
              <div class="detail-value">${quote.adminNotes}</div>
            </div>
          ` : ''}

          ${quote.quoteAmount ? `
            <div class="project-description" style="border-left-color: #28a745;">
              <div class="detail-label">Quote Amount</div>
              <div class="detail-value"><strong>¬£${quote.quoteAmount}</strong></div>
            </div>
          ` : ''}

          <div class="quote-actions">
            <button class="btn btn-primary" onclick="openQuoteModal(${quote.id})">‚úèÔ∏è Update</button>
            <button class="btn btn-success" onclick="callClient('${quote.phone}')">üìû Call</button>
            <button class="btn btn-warning" onclick="emailClient('${quote.email}')">üìß Email</button>
            <button class="btn btn-danger" onclick="deleteQuote(${quote.id})">üóëÔ∏è Delete</button>
          </div>
        </div>
      `;
    }

    function formatServiceType(type) {
      const types = {
        'home-improvement': 'Home Improvement',
        'plumbing': 'Plumbing',
        'electrical': 'Electrical Work',
        'heating-cooling': 'Heating & Cooling',
        'roofing': 'Roofing',
        'painting': 'Painting & Decorating',
        'garden-landscaping': 'Garden & Landscaping',
        'cleaning': 'Cleaning Services',
        'other': 'Other'
      };
      return types[type] || type;
    }

    function formatBudget(budget) {
      const budgets = {
        'under-500': 'Under ¬£500',
        '500-1000': '¬£500 - ¬£1,000',
        '1000-2500': '¬£1,000 - ¬£2,500',
        '2500-5000': '¬£2,500 - ¬£5,000',
        '5000-10000': '¬£5,000 - ¬£10,000',
        'over-10000': 'Over ¬£10,000'
      };
      return budgets[budget] || 'Not specified';
    }

    function formatUrgency(urgency) {
      const urgencies = {
        'asap': 'ASAP - Emergency',
        'within-week': 'Within a week',
        'within-month': 'Within a month',
        'within-3months': 'Within 3 months',
        'flexible': 'Flexible'
      };
      return urgencies[urgency] || 'Not specified';
    }

    function formatContactPreference(pref) {
      const prefs = {
        'phone': 'üìû Phone call',
        'email': 'üìß Email',
        'text': 'üì± Text message',
        'whatsapp': 'üí¨ WhatsApp'
      };
      return prefs[pref] || pref;
    }

    function updateStats() {
      const newCount = quotes.filter(q => q.status === 'new').length;
      const progressCount = quotes.filter(q => q.status === 'contacted' || q.status === 'quoted').length;
      const completedCount = quotes.filter(q => q.status === 'completed').length;
      
      document.getElementById('newCount').textContent = newCount;
      document.getElementById('progressCount').textContent = progressCount;
      document.getElementById('completedCount').textContent = completedCount;
      document.getElementById('totalCount').textContent = quotes.length;
    }

    function filterQuotes() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const statusFilter = document.getElementById('statusFilter').value;
      const serviceFilter = document.getElementById('serviceFilter').value;
      
      const cards = document.querySelectorAll('.quote-card');
      
      cards.forEach(card => {
        const quote = quotes.find(q => q.id == card.dataset.id);
        if (!quote) return;
        
        const matchesSearch = !searchTerm || 
          quote.fullName.toLowerCase().includes(searchTerm) ||
          quote.email.toLowerCase().includes(searchTerm) ||
          quote.serviceType.toLowerCase().includes(searchTerm) ||
          quote.projectDetails.toLowerCase().includes(searchTerm);
        
        const matchesStatus = !statusFilter || quote.status === statusFilter;
        const matchesService = !serviceFilter || quote.serviceType === serviceFilter;
        
        card.style.display = matchesSearch && matchesStatus && matchesService ? 'block' : 'none';
      });
    }

    function openQuoteModal(id) {
      const quote = quotes.find(q => q.id === id);
      if (!quote) return;
      
      currentEditId = id;
      document.getElementById('modalStatus').value = quote.status;
      document.getElementById('modalNotes').value = quote.adminNotes || '';
      document.getElementById('modalQuoteAmount').value = quote.quoteAmount || '';
      
      document.getElementById('quoteModal').style.display = 'block';
    }

    function closeModal() {
      document.getElementById('quoteModal').style.display = 'none';
      currentEditId = null;
    }

    function updateQuoteStatus() {
      if (!currentEditId) return;
      
      const formData = new FormData(document.getElementById('updateForm'));
      const quote = quotes.find(q => q.id === currentEditId);
      
      if (quote) {
        quote.status = formData.get('status');
        quote.adminNotes = formData.get('notes');
        quote.quoteAmount = formData.get('quoteAmount') ? parseFloat(formData.get('quoteAmount')) : null;
        
        localStorage.setItem('quoteRequests', JSON.stringify(quotes));
        renderQuotes();
        updateStats();
        closeModal();
        
        alert('‚úÖ Quote updated successfully!');
      }
    }

    function callClient(phone) {
      window.open(`tel:${phone}`, '_self');
    }

    function emailClient(email) {
      window.open(`mailto:${email}?subject=Your Quote Request&body=Dear Customer,%0D%0A%0D%0AThank you for your quote request. We would like to discuss your project with you.%0D%0A%0D%0ABest regards`, '_blank');
    }

    function deleteQuote(id) {
      if (confirm('Are you sure you want to delete this quote request?')) {
        quotes = quotes.filter(q => q.id !== id);
        localStorage.setItem('quoteRequests', JSON.stringify(quotes));
        renderQuotes();
        updateStats();
        alert('‚úÖ Quote deleted successfully!');
      }
    }

    function exportData() {
      if (quotes.length === 0) {
        alert('No data to export!');
        return;
      }
      
      const headers = ['Name', 'Email', 'Phone', 'Address', 'Service', 'Budget', 'Urgency', 'Status', 'Submitted', 'Quote Amount', 'Notes'];
      const csvContent = [
        headers.join(','),
        ...quotes.map(quote => [
          `"${quote.fullName}"`,
          `"${quote.email}"`,
          `"${quote.phone}"`,
          `"${quote.streetAddress}, ${quote.city}, ${quote.postcode}"`,
          `"${formatServiceType(quote.serviceType)}"`,
          `"${formatBudget(quote.budget)}"`,
          `"${formatUrgency(quote.urgency)}"`,
          `"${quote.status}"`,
          `"${new Date(quote.submissionDate).toLocaleDateString('en-GB')}"`,
          `"${quote.quoteAmount || ''}"`,
          `"${quote.adminNotes || ''}"`
        ].join(','))
      ].join('\n');
      
      const blob = new Blob([csvContent], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `quote-requests-${new Date().toISOString().split('T')[0]}.csv`;
      a.click();
      window.URL.revokeObjectURL(url);
    }

    // Function to receive new quotes from the form (this simulates form submission)
    function addNewQuote(quoteData) {
      const newQuote = {
        id: Date.now(),
        ...quoteData,
        status: 'new',
        adminNotes: '',
        quoteAmount: null
      };
      
      quotes.unshift(newQuote); // Add to beginning of array
      localStorage.setItem('quoteRequests', JSON.stringify(quotes));
      renderQuotes();
      updateStats();
      
      // Show notification
      alert(`üéâ New quote request received from ${newQuote.fullName}!`);
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('quoteModal');
      if (event.target === modal) {
        closeModal();
      }
    }
  </script>
</body>
</html>